define(["require","jquery","underscore","monster","toastr"],function(e){var t=e("jquery"),n=e("underscore"),r=e("monster"),i=e("toastr"),s={requests:{},subscribe:{"common.numberPrepend.renderPopup":"numberPrependEdit"},numberPrependEdit:function(e){var t=this;t.numberPrependGetNumber(e.phoneNumber,function(n){t.numberPrependRender(n.data,e.callbacks)})},numberPrependRender:function(e,n){var s=this,o=t(r.template(s,"numberPrepend-layout",e.prepend||{})),u;o.find(".save").on("click",function(o){o.preventDefault();var a=r.ui.getFormData("number_prepend");a.enabled=a.name&&a.name.length>0?!0:!1,t.extend(!0,e,{prepend:a}),s.numberPrependUpdateNumber(e.id,e,function(e){var t=r.util.formatPhoneNumber(e.data.id),o=r.template(s,"!"+s.i18n.active().numberPrepend.successUpdate,{phoneNumber:t});i.success(o),u.dialog("destroy").remove(),n.success&&n.success(e)},function(e){n.error&&n.error(e)})}),o.find(".cancel-link").on("click",function(e){e.preventDefault(),u.dialog("destroy").remove()}),u=r.ui.dialog(o,{title:s.i18n.active().numberPrepend.dialogTitle})},numberPrependGetNumber:function(e,t,n){var r=this;r.callApi({resource:"numbers.get",data:{accountId:r.accountId,phoneNumber:encodeURIComponent(e)},success:function(e,n){t&&t(e)},error:function(e,t){n&&n(e)}})},numberPrependUpdateNumber:function(e,t,n,r){var i=this;i.callApi({resource:"numbers.update",data:{accountId:i.accountId,phoneNumber:encodeURIComponent(e),data:t},success:function(e,t){n&&n(e)},error:function(e,t){r&&r(e)}})}};return s});